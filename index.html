<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DevMods - Trusted mods & tested APKs</title>
    <link rel="icon" type="image/png" href="https://files.catbox.moe/446l54.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <style>
        .fade-in {
            animation: fadeIn 0.5s;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .slide-down {
            animation: slideDown 0.3s ease-out;
        }
        @keyframes slideDown {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .toast {
            animation: toast 3.5s forwards;
        }
        @keyframes toast {
            0% { transform: translateY(100px); opacity: 0; }
            10% { transform: translateY(0); opacity: 1; }
            90% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(100px); opacity: 0; }
        }
        .countdown-pulse {
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        .pagination-active {
            background-color: #4f46e5;
            color: white;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-slate-50 to-white text-slate-900">
    <!-- Header -->
    <header class="border-b bg-white/60 backdrop-blur sticky top-0 z-40">
        <div class="max-w-6xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-lg bg-gradient-to-br from-indigo-500 to-pink-500 flex items-center justify-center text-white font-bold">
                    <img src="https://files.catbox.moe/446l54.jpg" alt="DevMods Logo" class="w-8 h-8 rounded-lg">
                </div>
                <div>
                    <h1 class="text-lg font-semibold">DevMods</h1>
                    <p class="text-xs text-slate-500">Trusted mods & tested APKs</p>
                </div>
            </div>

            <nav class="hidden md:flex items-center gap-6">
                <input id="search-input" placeholder="Search apps, features, versions..." class="px-3 py-2 border rounded-md w-80 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300" />

                <div class="flex items-center gap-3" id="category-buttons">
                    <!-- Categories will be populated by JavaScript -->
                </div>

                
            </nav>

            <div class="md:hidden">
                <button id="mobile-menu-button" class="p-2 rounded-md border hover:bg-slate-100 transition-colors">
                    <i class="fa fa-bars"></i>
                </button>
            </div>
        </div>

        <!-- Mobile nav -->
        <div id="mobile-nav" class="md:hidden border-t hidden slide-down">
            <div class="px-4 py-4 flex flex-col gap-3">
                <input id="mobile-search-input" placeholder="Search..." class="px-3 py-2 border rounded-md w-full text-sm focus:outline-none focus:ring-2 focus:ring-indigo-300" />
                <div class="flex gap-2 flex-wrap" id="mobile-category-buttons">
                    <!-- Categories will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </header>

    <!-- Main content -->
    <main class="max-w-6xl mx-auto px-4 py-8">
        <section class="grid lg:grid-cols-4 gap-6">
            <!-- Left: Filters / About -->
            <aside class="lg:col-span-1 bg-white shadow-sm rounded-2xl p-4 sticky top-24 h-fit">
                <h3 class="font-semibold">Filters</h3>
                <div class="mt-3 flex flex-col gap-2">
                    <label class="text-xs text-slate-500">Category</label>
                    <select id="category-select" class="px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-indigo-300">
                        <!-- Options will be populated by JavaScript -->
                    </select>
                </div>

                
                
            </aside>

            <!-- Right: APK grid/list -->
            <div class="lg:col-span-3">
                <div class="flex items-center justify-between mb-4">
                    <h2 class="text-2xl font-semibold">Apps & Games</h2>
                    <p class="text-sm text-slate-500">Showing <span id="results-count" class="font-medium">0</span> results</p>
                </div>

                <div id="apk-grid" class="grid md:grid-cols-2 gap-4">
                    <!-- APK items will be populated by JavaScript -->
                </div>

                <!-- Pagination -->
                <div id="pagination" class="mt-6 flex justify-center hidden">
                    <div class="flex gap-2">
                        <!-- Page numbers will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Newsletter -->
                

                <!-- Footer reference area (short) -->
                <footer class="mt-8 text-sm text-slate-500">
                    <p>All files are hosted on external services. Always scan APKs before installing. DevMods does not take responsibility for misuse.</p>
                </footer>
            </div>
        </section>
    </main>

    <!-- Download Modal -->
    <div id="download-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 hidden">
        <div class="absolute inset-0 bg-black/40 backdrop-blur-sm" id="modal-backdrop"></div>

        <div class="relative bg-white rounded-2xl shadow-xl max-w-xl w-full p-6 z-10 fade-in">
            <div class="flex items-start justify-between">
                <div>
                    <h3 id="modal-title" class="text-xl font-semibold"></h3>
                    <p id="modal-details" class="text-xs text-slate-500"></p>
                </div>
                <button id="close-modal" class="p-2 rounded-md border hover:bg-slate-100 transition-colors"><i class="fa fa-xmark"></i></button>
            </div>

            <p id="modal-description" class="mt-3 text-sm text-slate-600"></p>

            <div class="mt-4">
                <h4 class="font-medium">Features</h4>
                <ul id="modal-features" class="list-disc ml-5 text-sm mt-2 text-slate-600">
                </ul>
            </div>

            <div class="mt-6 flex items-center gap-3 flex-wrap">
                <button id="prepare-download" class="px-3 py-2 bg-amber-500 rounded-md text-white hover:bg-amber-600 transition-colors">Prepare Download</button>

                <button id="copy-direct-link" class="px-3 py-2 border rounded-md hover:bg-slate-50 transition-colors">Copy Direct Link</button>

                <div id="modal-tested" class="ml-auto text-sm text-slate-500"></div>
            </div>

            <div id="countdown-section" class="mt-4 flex items-center gap-3 flex-wrap hidden">
                <div class="px-3 py-2 border rounded-md countdown-pulse">Download enabled in <strong id="countdown">6</strong>s</div>
                <button id="start-download" class="px-3 py-2 rounded-md bg-slate-200 text-slate-400 cursor-not-allowed">
                    Please wait
                </button>
            </div>
        </div>
    </div>

    <!-- Footer: full -->
    <div class="mt-12 bg-slate-900 text-white py-8">
        <div class="max-w-6xl mx-auto px-4 grid md:grid-cols-4 gap-6">
            <div>
                <h5 class="font-semibold text-lg">DevMods</h5>
                <p class="text-xs text-slate-300 mt-2">Your source for tested and curated APK mods. Use responsibly.</p>
            </div>

            <div>
                <h6 class="font-semibold">Sections</h6>
                <ul class="text-xs mt-2 space-y-2 text-slate-300">
                    <li class="hover:text-white transition-colors cursor-pointer">Apps</li>
                    <li class="hover:text-white transition-colors cursor-pointer">Games</li>
                    <li class="hover:text-white transition-colors cursor-pointer">Top Mods</li>
                </ul>
            </div>

            <div>
                <h6 class="font-semibold">Quick Links</h6>
                <ul class="text-xs mt-2 space-y-2 text-slate-300">
                    <li class="hover:text-white transition-colors cursor-pointer">About</li>
                    <li class="hover:text-white transition-colors cursor-pointer">Contact</li>
                    <li class="hover:text-white transition-colors cursor-pointer">Privacy</li>
                </ul>
            </div>

            <div>
                <h6 class="font-semibold">Contact</h6>
                <p class="text-xs mt-2 text-slate-300">Telegram: @devmods
                <br/>Email: contact@devmods.example</p>
            </div>
        </div>

        <div class="mt-6 text-center text-xs text-slate-400">© <span id="current-year"></span> DevMods — All rights reserved.</div>
    </div>

    <!-- Copy status toast -->
    <div id="copy-toast" class="fixed bottom-6 right-6 bg-slate-900 text-white px-4 py-2 rounded-md shadow-lg z-50 hidden toast"></div>

    <script>
        // Sample APK data with Catbox-hosted app logos
        const sampleData = [
            {
                id: 1,
                title: "Spotify",
                category: "Apps",
                version: "2.3.1",
                size: "28 MB",
                description: "Premium unlock, Ads Free, unlimited .",
                features: ["premium unlock", "ads remove"],
                updated: "2025-08-20",
                tested: true,
                isNew: true,
                imageUrl: "https://files.catbox.moe/ggzozg.jpg", // Using the same logo for demo
                download: "https://www.mediafire.com/example/apk1"
            },
            {
                id: 2,
                title: "ChatX Mod",
                category: "Games",
                version: "1.8.0",
                size: "14 MB",
                description: "Premium features unlocked and message scheduling.",
                features: ["Premium Unlocked", "Schedule Messages"],
                updated: "2025-07-30",
                tested: true,
                isNew: false,
                imageUrl: "https://files.catbox.moe/gy2l02.jpg", // Using the same logo for demo
                download: "https://www.mediafire.com/example/apk2"
            },
            {
                id: 3,
                title: "PhotoMaster Lite",
                category: "Apps",
                version: "5.0.2",
                size: "42 MB",
                description: "Pro filters and batch export enabled.",
                features: ["Pro Filters", "Batch Export"],
                updated: "2025-08-25",
                tested: false,
                isNew: true,
                imageUrl: "https://files.catbox.moe/gy2l02.jpg", // Using the same logo for demo
                download: "https://www.mediafire.com/example/apk3"
            }
        ];

        // Generate more sample data to test pagination
        function generateMoreData() {
            const categories = ["Apps", "Games", "Tools", "Entertainment"];
            const features = ["Premium Unlocked", "Ads Removed", "Unlimited Coins", "Pro Features", "No Root Required"];
            
            let newData = [...sampleData];
            
            for (let i = 4; i <= 25; i++) {
                const category = categories[Math.floor(Math.random() * categories.length)];
                const featureCount = Math.floor(Math.random() * 3) + 1;
                const apkFeatures = [];
                
                for (let j = 0; j < featureCount; j++) {
                    const randomFeature = features[Math.floor(Math.random() * features.length)];
                    if (!apkFeatures.includes(randomFeature)) {
                        apkFeatures.push(randomFeature);
                    }
                }
                
                newData.push({
                    id: i,
                    title: `App ${i}`,
                    category: category,
                    version: `${Math.floor(Math.random() * 5) + 1}.${Math.floor(Math.random() * 10)}.${Math.floor(Math.random() * 10)}`,
                    size: `${Math.floor(Math.random() * 50) + 10} MB`,
                    description: `Description for App ${i} with amazing features.`,
                    features: apkFeatures,
                    updated: `2025-${Math.floor(Math.random() * 12) + 1}-${Math.floor(Math.random() * 28) + 1}`,
                    tested: Math.random() > 0.3,
                    isNew: Math.random() > 0.7,
                    imageUrl: "https://files.catbox.moe/gy2l02.jpg",
                    download: `https://www.mediafire.com/example/apk${i}`
                });
            }
            
            return newData;
        }

        // State management
        let data = sampleData; // Only the 3 apps you defined
        let query = "";
        let category = "All";
        let selectedApk = null;
        let countdown = 6;
        let countdownInterval = null;
        let downloading = false;
        let currentPage = 1;
        const itemsPerPage = 15;

        // DOM elements
        const searchInput = document.getElementById('search-input');
        const mobileSearchInput = document.getElementById('mobile-search-input');
        const categoryButtons = document.getElementById('category-buttons');
        const mobileCategoryButtons = document.getElementById('mobile-category-buttons');
        const categorySelect = document.getElementById('category-select');
        const apkGrid = document.getElementById('apk-grid');
        const resultsCount = document.getElementById('results-count');
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileNav = document.getElementById('mobile-nav');
       
        const downloadModal = document.getElementById('download-modal');
        const modalBackdrop = document.getElementById('modal-backdrop');
        const closeModal = document.getElementById('close-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalDetails = document.getElementById('modal-details');
        const modalDescription = document.getElementById('modal-description');
        const modalFeatures = document.getElementById('modal-features');
        const modalTested = document.getElementById('modal-tested');
        const prepareDownload = document.getElementById('prepare-download');
        const copyDirectLink = document.getElementById('copy-direct-link');
        const countdownSection = document.getElementById('countdown-section');
        const countdownElement = document.getElementById('countdown');
        const startDownload = document.getElementById('start-download');
        const copyToast = document.getElementById('copy-toast');
        const currentYear = document.getElementById('current-year');
        const paginationContainer = document.getElementById('pagination');

        // Initialize the page
        function init() {
            // Set current year in footer
            currentYear.textContent = new Date().getFullYear();
            
            // Extract categories
            const categories = ["All", ...new Set(data.map(item => item.category))];
            
            // Populate category buttons
            populateCategories(categories, categoryButtons);
            populateCategories(categories, mobileCategoryButtons);
            
            // Populate category select
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.textContent = cat;
                categorySelect.appendChild(option);
            });
            
            // Set initial category
            categorySelect.value = category;
            
            // Render APKs
            renderApks();
            
            // Add event listeners
            setupEventListeners();
        }

        // Populate category buttons
        function populateCategories(categories, container) {
            container.innerHTML = '';
            categories.forEach(cat => {
                const button = document.createElement('button');
                button.textContent = cat;
                button.className = `px-3 py-2 rounded-md text-sm ${category === cat ? 'bg-indigo-600 text-white' : 'text-slate-600 hover:bg-slate-100'} transition-colors`;
                button.addEventListener('click', () => {
                    category = cat;
                    categorySelect.value = cat;
                    currentPage = 1; // Reset to first page when category changes
                    updateCategoryButtons();
                    renderApks();
                    if (mobileNav.classList.contains('hidden') === false) {
                        mobileNav.classList.add('hidden');
                        mobileMenuButton.querySelector('i').className = 'fa fa-bars';
                    }
                });
                container.appendChild(button);
            });
        }

        // Update category buttons active state
        function updateCategoryButtons() {
            document.querySelectorAll('#category-buttons button, #mobile-category-buttons button').forEach(button => {
                if (button.textContent === category) {
                    button.className = 'px-3 py-2 rounded-md text-sm bg-indigo-600 text-white transition-colors';
                } else {
                    button.className = 'px-3 py-2 rounded-md text-sm text-slate-600 hover:bg-slate-100 transition-colors';
                }
            });
            categorySelect.value = category;
        }

        // Filter APKs based on query and category
        function filterApks() {
            return data
                .filter(apk => category === "All" ? true : apk.category === category)
                .filter(apk => 
                    apk.title.toLowerCase().includes(query.toLowerCase()) || 
                    apk.description.toLowerCase().includes(query.toLowerCase())
                )
                .sort((a, b) => new Date(b.updated) - new Date(a.updated));
        }

        // Get current page data
        function getCurrentPageData(filteredApks) {
            const startIndex = (currentPage - 1) * itemsPerPage;
            return filteredApks.slice(startIndex, startIndex + itemsPerPage);
        }

        // Render pagination
        function renderPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            
            if (totalPages <= 1) {
                paginationContainer.classList.add('hidden');
                return;
            }
            
            paginationContainer.classList.remove('hidden');
            const paginationElement = paginationContainer.querySelector('div');
            paginationElement.innerHTML = '';
            
            // Previous button
            if (currentPage > 1) {
                const prevButton = document.createElement('button');
                prevButton.innerHTML = '<i class="fa fa-chevron-left"></i>';
                prevButton.className = 'px-3 py-2 rounded-md border hover:bg-slate-100 transition-colors';
                prevButton.addEventListener('click', () => {
                    currentPage--;
                    renderApks();
                    window.scrollTo({ top: apkGrid.offsetTop - 100, behavior: 'smooth' });
                });
                paginationElement.appendChild(prevButton);
            }
            
            // Page numbers
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);
            
            if (endPage - startPage + 1 < maxVisiblePages) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }
            
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.textContent = i;
                pageButton.className = `px-3 py-2 rounded-md border hover:bg-slate-100 transition-colors ${currentPage === i ? 'pagination-active' : ''}`;
                pageButton.addEventListener('click', () => {
                    currentPage = i;
                    renderApks();
                    window.scrollTo({ top: apkGrid.offsetTop - 100, behavior: 'smooth' });
                });
                paginationElement.appendChild(pageButton);
            }
            
            // Next button
            if (currentPage < totalPages) {
                const nextButton = document.createElement('button');
                nextButton.innerHTML = '<i class="fa fa-chevron-right"></i>';
                nextButton.className = 'px-3 py-2 rounded-md border hover:bg-slate-100 transition-colors';
                nextButton.addEventListener('click', () => {
                    currentPage++;
                    renderApks();
                    window.scrollTo({ top: apkGrid.offsetTop - 100, behavior: 'smooth' });
                });
                paginationElement.appendChild(nextButton);
            }
        }

        // Render APKs to the grid
        function renderApks() {
            const filteredApks = filterApks();
            resultsCount.textContent = filteredApks.length;
            
            const currentPageData = getCurrentPageData(filteredApks);
            
            apkGrid.innerHTML = '';
            
            if (currentPageData.length === 0) {
                apkGrid.innerHTML = '<p class="text-center col-span-2 py-8 text-slate-500">No APKs found matching your criteria.</p>';
                paginationContainer.classList.add('hidden');
                return;
            }
            
            currentPageData.forEach(apk => {
                const apkElement = document.createElement('article');
                apkElement.className = 'bg-white rounded-2xl p-4 shadow-sm flex gap-4 items-start hover:shadow-md transition-all duration-300 fade-in';
                apkElement.innerHTML = `
                    <div class="w-20 h-20 rounded-lg bg-gradient-to-br from-indigo-200 to-pink-200 flex items-center justify-center font-bold text-xl text-white overflow-hidden">
                        <img src="${apk.imageUrl}" alt="${apk.title}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-1">
                        <div class="flex items-start justify-between gap-3">
                            <div>
                                <h3 class="font-semibold">${apk.title} <span class="text-xs text-slate-500 font-medium">v${apk.version}</span></h3>
                                <p class="text-xs text-slate-400">${apk.size} • Updated ${apk.updated}</p>
                            </div>
                            <div class="flex items-center gap-2">
                                ${apk.isNew ? '<span class="px-2 py-1 text-xs bg-amber-100 text-amber-700 rounded-full">New</span>' : ''}
                                <span class="px-2 py-1 text-xs rounded-full ${apk.tested ? 'bg-emerald-100 text-emerald-700' : 'bg-slate-100 text-slate-600'}">${apk.tested ? 'Tested' : 'Untested'}</span>
                            </div>
                        </div>
                        <p class="text-sm mt-2 text-slate-600">${apk.description}</p>
                        <ul class="flex flex-wrap gap-2 mt-3">
                            ${apk.features.map(feature => `<li class="text-xs px-2 py-1 border rounded-full">${feature}</li>`).join('')}
                        </ul>
                        <div class="mt-4 flex items-center gap-3">
                            <button class="download-btn px-3 py-2 rounded-md bg-indigo-600 text-white hover:scale-[1.01] transition-all flex items-center gap-2" data-id="${apk.id}">
                                <i class="fa fa-download"></i> Download
                            </button>
                            <button class="copy-link-btn px-3 py-2 rounded-md border text-sm hover:bg-slate-50 transition-colors" data-url="${apk.download}">Copy Link</button>
                            
                        </div>
                    </div>
                `;
                apkGrid.appendChild(apkElement);
            });
            
            // Render pagination
            renderPagination(filteredApks.length);
            
            // Add event listeners to the new buttons
            document.querySelectorAll('.download-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.closest('.download-btn').dataset.id);
                    openDownloadModal(id);
                });
            });
            
            document.querySelectorAll('.copy-link-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const url = e.target.closest('.copy-link-btn').dataset.url;
                    copyToClipboard(url);
                });
            });
        }

        // Open download modal
        function openDownloadModal(id) {
            selectedApk = data.find(apk => apk.id === id);
            if (!selectedApk) return;
            
            // Reset download state
            downloading = false;
            countdown = 6;
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
            
            // Update modal content
            modalTitle.innerHTML = `${selectedApk.title} <span class="text-sm text-slate-500">v${selectedApk.version}</span>`;
            modalDetails.textContent = `${selectedApk.size} • Updated ${selectedApk.updated}`;
            modalDescription.textContent = selectedApk.description;
            
            // Populate features
            modalFeatures.innerHTML = '';
            selectedApk.features.forEach(feature => {
                const li = document.createElement('li');
                li.textContent = feature;
                modalFeatures.appendChild(li);
            });
            
            modalTested.textContent = selectedApk.tested ? 'Marked as tested' : 'Not verified';
            
            // Hide countdown section
            countdownSection.classList.add('hidden');
            startDownload.disabled = true;
            startDownload.className = 'px-3 py-2 rounded-md bg-slate-200 text-slate-400 cursor-not-allowed';
            startDownload.textContent = 'Please wait';
            
            // Show modal
            downloadModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
        }

        // Close download modal
        function closeDownloadModal() {
            downloadModal.classList.add('hidden');
            document.body.style.overflow = 'auto';
            selectedApk = null;
            downloading = false;
            if (countdownInterval) {
                clearInterval(countdownInterval);
                countdownInterval = null;
            }
        }

        // Prepare download (start countdown)
        function prepareDownloadHandler() {
            downloading = true;
            countdownSection.classList.remove('hidden');
            startDownload.disabled = true;
            startDownload.className = 'px-3 py-2 rounded-md bg-slate-200 text-slate-400 cursor-not-allowed';
            startDownload.textContent = 'Please wait';
            
            countdownElement.textContent = countdown;
            
            countdownInterval = setInterval(() => {
                countdown--;
                countdownElement.textContent = countdown;
                
                if (countdown <= 0) {
                    clearInterval(countdownInterval);
                    startDownload.disabled = false;
                    startDownload.className = 'px-3 py-2 rounded-md bg-indigo-600 text-white hover:bg-indigo-700 transition-colors';
                    startDownload.textContent = 'Start Download';
                }
            }, 1000);
        }

        // Perform download
        function performDownload() {
            if (countdown > 0) return;
            window.open(selectedApk.download, '_blank', 'noreferrer');
            closeDownloadModal();
        }

        // Copy to clipboard with fallbacks
        async function copyToClipboard(text) {
            if (!text) return false;
            
            try {
                if (navigator.clipboard && typeof navigator.clipboard.writeText === 'function') {
                    await navigator.clipboard.writeText(text);
                    showToast('Link copied to clipboard!');
                    return true;
                }
                throw new Error('Clipboard API not available');
            } catch (err) {
                try {
                    const textarea = document.createElement('textarea');
                    textarea.value = text;
                    textarea.setAttribute('readonly', '');
                    textarea.style.position = 'absolute';
                    textarea.style.left = '-9999px';
                    document.body.appendChild(textarea);
                    textarea.select();
                    textarea.setSelectionRange(0, textarea.value.length);
                    
                    const ok = document.execCommand('copy');
                    document.body.removeChild(textarea);
                    
                    if (ok) {
                        showToast('Link copied to clipboard (fallback)');
                        return true;
                    }
                    throw new Error('execCommand failed');
                } catch (err2) {
                    try {
                        window.prompt('Copy the link below (Ctrl/Cmd+C):', text);
                    } catch (e) {
                        // ignore
                    }
                    
                    showToast("Couldn't copy automatically — please copy manually.");
                    return false;
                }
            }
        }

        // Show toast message
        function showToast(message) {
            copyToast.textContent = message;
            copyToast.classList.remove('hidden');
            
            setTimeout(() => {
                copyToast.classList.add('hidden');
            }, 3500);
        }

        // Set up event listeners
        function setupEventListeners() {
            // Search input
            searchInput.addEventListener('input', (e) => {
                query = e.target.value;
                currentPage = 1; // Reset to first page when search changes
                renderApks();
            });
            
            mobileSearchInput.addEventListener('input', (e) => {
                query = e.target.value;
                currentPage = 1; // Reset to first page when search changes
                renderApks();
            });
            
            // Category select
            categorySelect.addEventListener('change', (e) => {
                category = e.target.value;
                currentPage = 1; // Reset to first page when category changes
                updateCategoryButtons();
                renderApks();
            });
            
            // Mobile menu
            mobileMenuButton.addEventListener('click', () => {
                mobileNav.classList.toggle('hidden');
                mobileMenuButton.querySelector('i').className = mobileNav.classList.contains('hidden') ? 'fa fa-bars' : 'fa fa-xmark';
            });
            
           
            
            // Modal events
            modalBackdrop.addEventListener('click', closeDownloadModal);
            closeModal.addEventListener('click', closeDownloadModal);
            prepareDownload.addEventListener('click', prepareDownloadHandler);
            copyDirectLink.addEventListener('click', () => copyToClipboard(selectedApk.download));
            startDownload.addEventListener('click', performDownload);
            
            // Close modal on Escape key
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape' && !downloadModal.classList.contains('hidden')) {
                    closeDownloadModal();
                }
            });
        }

        // Initialize the app when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
